language: cpp
dist: xenial

matrix:
  include:
  - os: linux
    addons:
      apt:
        sources:
        - ubuntu-toolchain-r-test
        packages:
        - g++-7
    env:
    - QT_SELECT="opt-qt512"
    compiler: gcc

before_install:
  - chmod +x ./build_scripts/linux/build_linux.sh
  - chmod +x ./build_scripts/linux/format.sh
  - chmod +x ./build_scripts/linux/run-clang-tidy.sh
  - chmod +x ./build_scripts/linux/verify_formatting.sh
  - sudo apt update -qq
  - python ./build_scripts/run-clang-format.py ./src -r --color always --clang-format-executable clang-format-8

install:
  - sudo add-apt-repository ppa:kubuntu-ppa/backports -y
  - sudo add-apt-repository ppa:beineri/opt-qt-5.12.2-xenial -y
  - sudo apt-get update -qq
  - sudo apt-get install build-essential libgl1-mesa-dev
  - sudo apt-get install qt512-meta-minimal qt512multimedia qt512declarative qt512quickcontrols2  qt512tools  qt512base
  - sudo apt-get install libx11-dev libxt-dev libxtst-dev
  - qtchooser -install opt-qt512 /opt/qt512/bin/qmake

script:
  - mkdir -v build
  - cd build
  - qmake --version
  - qmake -spec linux-g++
  - make --jobs
